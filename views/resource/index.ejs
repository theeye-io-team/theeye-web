<% block('scripts','<script> window.Tags = ' + JSON.stringify(tags) + '; </script>') %>
<% block('scripts','<script> window.Looptimes = ' + JSON.stringify(looptimes) + '; </script>') %>
<% block('scripts','<script> window.Timeouts = ' + JSON.stringify(timeouts) + '; </script>') %>
<% block('scripts','<script> window.Hosts = ' + JSON.stringify(hosts) + '; </script>') %>
<% block('scripts','<script> window.Scripts = ' + JSON.stringify(scripts) + '; </script>') %>
<% block('scripts','<script> $(document).ready(function(){ new ScriptsPageInit(); new MonitorsPageInit(); }); </script>') %>

<!-- Main  -->
<div class="admin-container monitorContainer">
  <div class="js-searchable-box">
    <form>
      <input type="text" placeholder="Find a Monitor">
      <button class="clean"><i class="glyphicon glyphicon-remove"></i></button>
      <button class="search"><i class="glyphicon glyphicon-search"></i></button>
    </form>
  </div>
  <div class="admin-panel resources-panel">
    <h3>Monitors Admin</h3>
    <div>
      <!-- PAGE HEADER -->
      <div class="table-header admin">
        <button class="mass-action massChecker btn btn-primary simple-btn tooltiped" title="Select all" aria-label="Center Align">
          <span class="massiveSelector glyphicon glyphicon-unchecked"></span>
        </button>
        <span class="title">Monitors &nbsp;<i data-hook="help"></i></span>
        <span class="title separator">|</span>

        <%- partial('./partials/menu/create-monitors-dropdown.ejs') %>
        <!-- DESKTOP/MOBILE MASSIVE MENU { -->
        <div class="panel-item panel-item-mobile icons dropdown">
          <button class="btn dropdown-toggle btn-primary simple-btn mobile-dropdown-button"
            type="button"
            id="dropdownMenu"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="true">
            <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
          </button>
          <ul class="dropdown-menu desktop-mobile-dropdown" aria-labelledby="dropdownMenu1">
            <%- partial('./partials/menu/massive-actions.ejs') %>
          </ul>
        </div>

        <div class="panel-item panel-item-desktop icons">
          <%- partial('./partials/menu/massive-actions.ejs') %>
        </div>
        <!-- } DESKTOP/MOBILE MASSIVE MENU -->

      </div>
      <!-- /PAGE HEADER -->

      <!-- PAGE CONTENT -->
      <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
        <% monitors.forEach( function(monitor, key) {
          var tags = [
            'id=' + monitor.resource.id,
            'name=' + monitor.resource.name,
            'hostname=' + monitor.resource.hostname,
            'type=' + monitor.type,
            'state=' + monitor.resource.state,
          ].concat(monitor.tags).join(',') %>

          <div class="itemRow panel panel-default js-searchable-item"
            data-item-id="<%= monitor.resource.id %>"
            data-item-name="<%= monitor.resource.name %>"
            data-tags="<%= tags %>">
            <div class="panel-heading" role="tab" id="heading<%= monitor.id %>">
              <h4 class="panel-title">
                <span class="collapsed"
                  data-toggle="collapse"
                  data-parent="#accordion"
                  href="#collapse<%= monitor.id %>"
                  aria-expanded="false"
                  aria-controls="collapse<%= monitor.id %>">
                  <div class="panel-title-content">

                    <% if (monitor.type == 'host') { %>
                      <button class="rowSelector-not btn btn-primary simple-btn tooltiped"
                        title="I'm a Host!"
                        aria-label="Center Align">
                        <span class="selectorIcon fa fa-server"></span>
                      </button>
                    <% } else { %>
                      <button class="rowSelector btn btn-primary simple-btn tooltiped"
                        title="Select monitor"
                        aria-label="Center Align">
                        <span class="selectorIcon glyphicon glyphicon-unchecked"></span>
                      </button>
                    <% } %>
                    <span class="panel-item name" id="<%= monitor.id %>">
                      <% if (monitor.template) { %>
                        <small>
                          <a href="/admin/template">
                            <span title="This monitor was created from a template"
                              class="glyphicon glyphicon-list-alt remark-success tooltiped">
                            </span>
                          </a>
                        </small>&nbsp;
                      <% } %>
                      <%= monitor.resource.name %>
                      <span class="monitor-<%= monitor.enable ? 'enabled' : 'disabled' %>">
                        <small>
                          <% if (monitor.resource.type != 'host') { %>
                            (<%= monitor.resource.hostname %>)
                          <% } %>
                          <%= !monitor.enable? ' > disabled' :'' %> > <%= monitor.type %>
                        </small>
                      </span>
                      <small class="<%= monitor.resource.state === 'normal' ? '' : 'remark-alert' %>">
                        > host status :: <%= monitor.resource.state %>
                      </small>
                    </span>

                    <!-- DESKTOP ICONS MENU -->
                    <div class="panel-item icons panel-item-desktop">
                      <% var type = (monitor.type||monitor.monitor_type) %>
                      <% if (type == 'host') { %>
                        <%- partial ('./partials/menu/host.ejs',{ monitor: monitor }) %>
                      <% } else if (type == 'psaux') { %>
                        <%- partial ('./partials/menu/psaux.ejs',{ monitor: monitor }) %>
                      <% } else { %>
                        <%- partial ('./partials/menu/monitors.ejs',{ monitor: monitor }) %>
                        <!-- TYPE SCRIPT, PROCESS OR SCRAPER -->
                      <% } %>
                    </div>
                    <!-- /DESKTOP ICONS MENU -->
                    <!-- MOBILE ICONS MENU -->
                    <div class="panel-item icons dropdown panel-item-mobile">
                      <button class="btn dropdown-toggle btn-primary simple-btn"
                        type="button"
                        id="dropdownMenu"
                        data-toggle="dropdown"
                        aria-haspopup="true"
                        aria-expanded="true">
                        <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                      <% var type = (monitor.type||monitor.monitor_type) %>
                      <% if (type == 'host') { %>
                        <%- partial ('./partials/menu/host.ejs',{ monitor: monitor }) %>
                      <% } else if (type == 'psaux') { %>
                        <%- partial ('./partials/menu/psaux.ejs',{ monitor: monitor }) %>
                      <% } else { %>
                        <%- partial ('./partials/menu/monitors.ejs',{ monitor: monitor }) %>
                        <!-- TYPE SCRIPT, PROCESS OR SCRAPER -->
                      <% } %>
                      </ul>
                    </div>
                    <!-- /MOBILE ICONS MENU -->

                  </div>
                </span>
              </h4>
            </div>
            <div id="collapse<%= monitor.id %>" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading<%= monitor.id %>">
              <div class="panel-body">
                <div>
                  <h4>Type</h4>
                  <p> <%= monitor.type %> </p>
                  <h4>Hostname</h4>
                  <p> <%= monitor.resource.hostname %> </p>
                </div>
              </div>
            </div>
          </div> <!-- end item -->
        <% }) %>
      </div>
      <!-- /PAGE CONTENT -->

    </div> <!-- Tableresults -->
  </div>
</div> <!-- main -->

<%- partial ('./partials/dstat-modal-form.ejs') %>
<%- partial ('./partials/process-modal-form.ejs') %>
<%- partial ('./partials/script-modal-form.ejs') %>
<%- partial ('../script/partials/modal.ejs') %>
